using TMPro;
using UnityEngine;
using UnityEngine.SceneManagement;

namespace UnderPressure.MainScene
{
    public class Download : MonoBehaviour
    {

        public float downloadTime;
        public float firstDownloadTime;
        public TMP_Text percentageText;
        private float _percentage;
        private float _downloadTimer;
        private bool _firstDownload = true;

        public void Start()
        {
            _downloadTimer = firstDownloadTime;
        }

        public void RestartButton()
        {
            _downloadTimer = downloadTime;
            _firstDownload = false;
        }
        
        public void Update()
        {
            if (_firstDownload)
            {
                _downloadTimer -= Time.deltaTime;
                _percentage = 100 - (_downloadTimer / firstDownloadTime * 100);
                percentageText.text = _percentage.ToString("F0") + "%";
            }
            else
            {
                _downloadTimer -= Time.deltaTime;
                _percentage = 100 - (_downloadTimer / downloadTime * 100);
                percentageText.text = _percentage.ToString("F0") + "%";
            }

            if (_downloadTimer <= 0)
            {
                Debug.Log("Game Over");
                SceneManager.LoadScene("ComputerCrash");
            }
        }

    }
}
